<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deriv Trading Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <style>
        :root {
            --primary-color: #1a2b47;
            --secondary-color: #2c3e50;
            --accent-color: #3498db;
            --success-color: #2ecc71;
            --danger-color: #e74c3c;
            --light-bg: #f8f9fa;
            --warning-color: #f39c12;
            --purple-color: #9b59b6;
            --btc-color: #f7931a;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-bg);
            color: #333;
        }
        
        .navbar {
            background-color: var(--primary-color);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
        }
        
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            margin-bottom: 20px;
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            background-color: var(--secondary-color);
            color: white;
            font-weight: 600;
            border-radius: 10px 10px 0 0 !important;
        }
        
        .btn-primary {
            background-color: var(--accent-color);
            border: none;
            border-radius: 50px;
            padding: 10px 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background-color: var(--success-color);
            border: none;
            border-radius: 50px;
            padding: 10px 25px;
            font-weight: 600;
        }
        
        .btn-danger {
            background-color: var(--danger-color);
            border: none;
            border-radius: 50px;
            padding: 10px 25px;
            font-weight: 600;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            border: none;
            border-radius: 50px;
            padding: 10px 25px;
            font-weight: 600;
        }
        
        .btn-purple {
            background-color: var(--purple-color);
            border: none;
            border-radius: 50px;
            padding: 10px 25px;
            font-weight: 600;
            color: white;
        }
        
        .btn-btc {
            background-color: var(--btc-color);
            border: none;
            border-radius: 50px;
            padding: 10px 25px;
            font-weight: 600;
            color: white;
        }
        
        .trading-panel {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .chart-container {
            height: 400px;
            position: relative;
        }
        
        .indicator {
            display: flex;
            justify-content: space-between;
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            background-color: #f1f1f1;
        }
        
        .indicator-value {
            font-weight: 700;
        }
        
        .strategy-status {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }
        
        .status-running {
            background-color: rgba(46, 204, 113, 0.2);
            color: var(--success-color);
        }
        
        .status-stopped {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger-color);
        }
        
        .account-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background-color: white;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .account-type {
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .demo-account {
            background-color: rgba(52, 152, 219, 0.2);
            color: var(--accent-color);
        }
        
        .real-account {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger-color);
        }
        
        .contact-banner {
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .footer {
            background-color: var(--primary-color);
            color: white;
            padding: 30px 0;
            margin-top: 50px;
        }
        
        .footer a {
            color: white;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .strategy-params {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .param-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .param-label {
            font-weight: 600;
        }
        
        .param-value {
            color: var(--accent-color);
            font-weight: 700;
        }
        
        .symbol-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background-color: #f1f1f1;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .symbol-name {
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .switch-indicator {
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .switch-auto {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--warning-color);
        }
        
        .switch-manual {
            background-color: rgba(52, 152, 219, 0.2);
            color: var(--accent-color);
        }
        
        .trade-count {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--accent-color);
            color: white;
            font-weight: 700;
            margin-left: 10px;
        }
        
        .modal-header {
            background-color: var(--primary-color);
            color: white;
        }
        
        .modal-header .btn-close {
            filter: invert(1);
        }
        
        .request-status {
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-weight: 600;
        }
        
        .status-pending {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--warning-color);
        }
        
        .status-approved {
            background-color: rgba(46, 204, 113, 0.2);
            color: var(--success-color);
        }
        
        .status-rejected {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger-color);
        }
        
        .donation-amount {
            font-size: 2rem;
            font-weight: 700;
            color: var(--btc-color);
            margin: 15px 0;
        }
        
        .qr-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }
        
        .wallet-address {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            word-break: break-all;
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .copy-button {
            margin-top: 10px;
        }
        
        .donation-steps {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .donation-steps h5 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .donation-steps ol {
            padding-left: 20px;
        }
        
        .donation-steps li {
            margin-bottom: 10px;
        }
        
        .tab-content {
            padding: 20px 0;
        }
        
        .nav-tabs {
            border-bottom: 1px solid #dee2e6;
            margin-bottom: 15px;
        }
        
        .nav-tabs .nav-link {
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .nav-tabs .nav-link.active {
            color: var(--accent-color);
            font-weight: 700;
        }
        
        .payment-method {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .payment-method i {
            font-size: 1.5rem;
            margin-right: 10px;
        }
        
        .payment-method h5 {
            margin: 0;
        }
        
        .contact-info {
            background-color: rgba(52, 152, 219, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .contact-info h5 {
            color: var(--accent-color);
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-chart-line me-2"></i>Deriv Trading Platform
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#"><i class="fas fa-home me-1"></i> Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-chart-bar me-1"></i> Analytics</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-cog me-1"></i> Settings</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-sign-out-alt me-1"></i> Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-4">
        <!-- Account Info -->
        <div class="account-info">
            <div>
                <h4>Account: <span id="account-id">Demo Account</span></h4>
                <p>Balance: $<span id="account-balance">10,000.00</span></p>
                <div class="mt-2">
                    <span class="account-type" id="account-type">DEMO</span>
                    <span id="auth-status" class="ms-2"></span>
                </div>
            </div>
            <div>
                <button class="btn btn-btc" id="request-real-trading">
                    <i class="fab fa-bitcoin me-1"></i> Upgrade to Real Trading
                </button>
            </div>
        </div>

        <!-- Real Trading Notice -->
        <div class="contact-banner">
            <h5><i class="fas fa-info-circle me-2"></i>Real Trading Information</h5>
            <p>Upgrade to real trading by donating $10 via Bitcoin. After donating, contact us with your transaction ID to receive your authorization code.</p>
        </div>

        <div class="row">
            <!-- Trading Panel -->
            <div class="col-lg-8">
                <div class="trading-panel">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4><i class="fas fa-chart-line me-2"></i>Auto-Switch Trading</h4>
                        <div>
                            <button class="btn btn-success" id="start-strategy">
                                <i class="fas fa-play me-1"></i> Start Strategy
                            </button>
                            <button class="btn btn-danger ms-2" id="stop-strategy" disabled>
                                <i class="fas fa-stop me-1"></i> Stop Strategy
                            </button>
                        </div>
                    </div>

                    <!-- Strategy Status -->
                    <div class="strategy-status status-stopped" id="strategy-status">
                        <i class="fas fa-circle me-2"></i> Strategy Stopped
                    </div>

                    <!-- Symbol Info -->
                    <div class="symbol-info">
                        <div>
                            <span class="symbol-name" id="current-symbol">CRASH900</span>
                            <span class="switch-indicator switch-auto" id="switch-mode">AUTO-SWITCH</span>
                        </div>
                        <div>
                            <span>Trades: </span>
                            <span class="trade-count" id="trade-count">0</span>
                            <span class="ms-2">/ 3</span>
                        </div>
                    </div>

                    <!-- Chart -->
                    <div class="chart-container">
                        <canvas id="trading-chart"></canvas>
                    </div>

                    <!-- Strategy Parameters -->
                    <div class="strategy-params">
                        <h5>Strategy Parameters</h5>
                        <div class="param-row">
                            <span class="param-label">Stake Amount:</span>
                            <span class="param-value">$1.00</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">Multiplier:</span>
                            <span class="param-value">100x</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">Take Profit:</span>
                            <span class="param-value">5%</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">Stop Loss:</span>
                            <span class="param-value">50%</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">EMA100 Period:</span>
                            <span class="param-value">100</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">EMA50 Period:</span>
                            <span class="param-value">50</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">RSI Period:</span>
                            <span class="param-value">2</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">Auto-Switch Time:</span>
                            <span class="param-value">2 minutes</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">Trades per Signal:</span>
                            <span class="param-value">3</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Indicators Panel -->
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-chart-area me-2"></i>Technical Indicators</h5>
                    </div>
                    <div class="card-body">
                        <div class="indicator">
                            <span>EMA100:</span>
                            <span class="indicator-value" id="ema100">--</span>
                        </div>
                        <div class="indicator">
                            <span>EMA50:</span>
                            <span class="indicator-value" id="ema50">--</span>
                        </div>
                        <div class="indicator">
                            <span>EMA50 (5min):</span>
                            <span class="indicator-value" id="ema50-5">--</span>
                        </div>
                        <div class="indicator">
                            <span>RSI (2):</span>
                            <span class="indicator-value" id="rsi">--</span>
                        </div>
                        <div class="indicator">
                            <span>Current Price:</span>
                            <span class="indicator-value" id="current-price">--</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-history me-2"></i>Recent Trades</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Symbol</th>
                                        <th>Result</th>
                                    </tr>
                                </thead>
                                <tbody id="trade-history">
                                    <tr>
                                        <td colspan="3" class="text-center">No trades yet</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-exclamation-triangle me-2"></i>Strategy Conditions</h5>
                    </div>
                    <div class="card-body">
                        <ul class="list-group">
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                RSI > 30
                                <span class="badge bg-secondary" id="cond1">--</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                EMA50 (5min) < Current Price
                                <span class="badge bg-secondary" id="cond2">--</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                EMA100 < EMA50
                                <span class="badge bg-secondary" id="cond3">--</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                EMA100 < Current Price
                                <span class="badge bg-secondary" id="cond4">--</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-sync-alt me-2"></i>Auto-Switch Status</h5>
                    </div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Current Symbol:</span>
                            <span class="fw-bold" id="switch-current-symbol">CRASH900</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Trades Placed:</span>
                            <span class="fw-bold" id="switch-trade-count">0 / 3</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Time Since Signal:</span>
                            <span class="fw-bold" id="switch-time-elapsed">0:00</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>Next Switch In:</span>
                            <span class="fw-bold" id="switch-time-remaining">2:00</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Donation Modal -->
    <div class="modal fade" id="donationModal" tabindex="-1" aria-labelledby="donationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="donationModalLabel">
                        <i class="fab fa-bitcoin me-2"></i>Upgrade to Real Trading
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center">
                        <h4>One-Time Donation: <span class="donation-amount">$10</span></h4>
                        <p class="text-muted">Donate $10 via Bitcoin to activate real trading on your account</p>
                    </div>
                    
                    <ul class="nav nav-tabs" id="paymentTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="bitcoin-tab" data-bs-toggle="tab" data-bs-target="#bitcoin" type="button" role="tab" aria-controls="bitcoin" aria-selected="true">
                                <i class="fab fa-bitcoin me-1"></i> Bitcoin
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="binance-tab" data-bs-toggle="tab" data-bs-target="#binance" type="button" role="tab" aria-controls="binance" aria-selected="false">
                                <i class="fas fa-coins me-1"></i> Binance Pay
                            </button>
                        </li>
                    </ul>
                    
                    <div class="tab-content" id="paymentTabsContent">
                        <div class="tab-pane fade show active" id="bitcoin" role="tabpanel" aria-labelledby="bitcoin-tab">
                            <div class="payment-method">
                                <i class="fab fa-bitcoin" style="color: var(--btc-color);"></i>
                                <h5>Bitcoin Payment</h5>
                            </div>
                            
                            <div class="qr-container">
                                <div id="btc-qrcode"></div>
                                <div class="wallet-address" id="btc-address">1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa</div>
                                <button class="btn btn-primary copy-button" id="copy-btc-address">
                                    <i class="fas fa-copy me-1"></i> Copy Address
                                </button>
                            </div>
                            
                            <div class="donation-steps">
                                <h5>After Donating:</h5>
                                <ol>
                                    <li>Send exactly $10 worth of Bitcoin to the address above</li>
                                    <li>Save your transaction ID</li>
                                    <li>Contact us at <strong>mouniroutrading@gmail.com</strong> with your transaction ID</li>
                                    <li>We'll verify your payment and send you an authorization code</li>
                                    <li>Enter the authorization code to activate real trading</li>
                                </ol>
                            </div>
                        </div>
                        
                        <div class="tab-pane fade" id="binance" role="tabpanel" aria-labelledby="binance-tab">
                            <div class="payment-method">
                                <i class="fas fa-coins" style="color: #f3ba2f;"></i>
                                <h5>Binance Pay</h5>
                            </div>
                            
                            <div class="qr-container">
                                <div id="binance-qrcode"></div>
                                <div class="wallet-address" id="binance-id">@mouniroutrading</div>
                                <button class="btn btn-primary copy-button" id="copy-binance-id">
                                    <i class="fas fa-copy me-1"></i> Copy ID
                                </button>
                            </div>
                            
                            <div class="donation-steps">
                                <h5>After Donating:</h5>
                                <ol>
                                    <li>Send exactly $10 via Binance Pay to the ID above</li>
                                    <li>Save your transaction ID</li>
                                    <li>Contact us at <strong>mouniroutrading@gmail.com</strong> with your transaction ID</li>
                                    <li>We'll verify your payment and send you an authorization code</li>
                                    <li>Enter the authorization code to activate real trading</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                    
                    <div class="contact-info">
                        <h5><i class="fas fa-envelope me-2"></i>Contact Information</h5>
                        <p><strong>Email:</strong> mouniroutrading@gmail.com</p>
                        <p><strong>Subject:</strong> Real Trading Authorization Request</p>
                        <p><strong>Include in your email:</strong> Your transaction ID and the email address associated with your account</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Authorization Code Modal -->
    <div class="modal fade" id="authorizationCodeModal" tabindex="-1" aria-labelledby="authorizationCodeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="authorizationCodeModalLabel">
                        <i class="fas fa-shield-alt me-2"></i>Enter Authorization Code
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>We've sent an authorization code to your email. Please enter it below to activate real trading.</p>
                    <form id="authorizationCodeForm">
                        <div class="mb-3">
                            <label for="authCode" class="form-label">Authorization Code</label>
                            <input type="text" class="form-control" id="authCode" placeholder="Enter 6-digit code" maxlength="6" required>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-check me-1"></i> Activate Real Trading
                            </button>
                        </div>
                    </form>
                    <div id="authStatus" class="request-status d-none"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>Deriv Trading Platform</h5>
                    <p>Automated trading strategies for synthetic indices</p>
                </div>
                <div class="col-md-3">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                        <li><a href="#">Contact Us</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h5>Contact</h5>
                    <p>Email: mouniroutrading@gmail.com</p>
                </div>
            </div>
            <hr class="mt-4">
            <div class="text-center">
                <p>&copy; 2023 Deriv Trading Platform. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize chart
            const ctx = document.getElementById('trading-chart').getContext('2d');
            const tradingChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Price',
                        data: [],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            // Strategy state
            let isStrategyRunning = false;
            let strategyInterval = null;
            let priceData = [];
            let tradeHistory = [];
            
            // Auto-switch state
            let currentSymbol = 'CRASH900';
            let tradeCount = 0;
            let lastSignalTime = null;
            let switchTimer = null;
            let timeElapsedInterval = null;
            
            // Authorization state
            let isRealTrading = false;
            let generatedAuthCode = null;

            // DOM elements
            const startBtn = document.getElementById('start-strategy');
            const stopBtn = document.getElementById('stop-strategy');
            const statusEl = document.getElementById('strategy-status');
            const accountTypeEl = document.getElementById('account-type');
            const accountIdEl = document.getElementById('account-id');
            const accountBalanceEl = document.getElementById('account-balance');
            const tradeHistoryEl = document.getElementById('trade-history');
            const currentSymbolEl = document.getElementById('current-symbol');
            const tradeCountEl = document.getElementById('trade-count');
            const authStatusEl = document.getElementById('auth-status');
            const requestRealTradingBtn = document.getElementById('request-real-trading');
            
            // Indicator elements
            const ema100El = document.getElementById('ema100');
            const ema50El = document.getElementById('ema50');
            const ema50_5El = document.getElementById('ema50-5');
            const rsiEl = document.getElementById('rsi');
            const currentPriceEl = document.getElementById('current-price');
            
            // Condition elements
            const cond1El = document.getElementById('cond1');
            const cond2El = document.getElementById('cond2');
            const cond3El = document.getElementById('cond3');
            const cond4El = document.getElementById('cond4');
            
            // Auto-switch elements
            const switchCurrentSymbolEl = document.getElementById('switch-current-symbol');
            const switchTradeCountEl = document.getElementById('switch-trade-count');
            const switchTimeElapsedEl = document.getElementById('switch-time-elapsed');
            const switchTimeRemainingEl = document.getElementById('switch-time-remaining');

            // Modal elements
            const donationModal = new bootstrap.Modal(document.getElementById('donationModal'));
            const authorizationCodeModal = new bootstrap.Modal(document.getElementById('authorizationCodeModal'));
            const authorizationCodeForm = document.getElementById('authorizationCodeForm');
            const authStatusElModal = document.getElementById('authStatus');

            // Initialize with demo account
            accountTypeEl.textContent = 'DEMO';
            accountTypeEl.className = 'account-type demo-account';
            accountIdEl.textContent = 'Demo Account';
            accountBalanceEl.textContent = '10,000.00';

            // Generate QR codes when modal is shown
            donationModal._element.addEventListener('shown.bs.modal', function() {
                // Generate Bitcoin QR code
                const btcQrContainer = document.getElementById('btc-qrcode');
                btcQrContainer.innerHTML = '';
                new QRCode(btcQrContainer, {
                    text: 'bitcoin:1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa?amount=0.0005',
                    width: 200,
                    height: 200,
                    colorDark: '#000000',
                    colorLight: '#ffffff',
                    correctLevel: QRCode.CorrectLevel.H
                });
                
                // Generate Binance Pay QR code
                const binanceQrContainer = document.getElementById('binance-qrcode');
                binanceQrContainer.innerHTML = '';
                new QRCode(binanceQrContainer, {
                    text: 'https://www.binance.com/en/pay/pay?merchantId=mouniroutrading&amount=10',
                    width: 200,
                    height: 200,
                    colorDark: '#000000',
                    colorLight: '#ffffff',
                    correctLevel: QRCode.CorrectLevel.H
                });
            });

            // Copy address functionality
            document.getElementById('copy-btc-address').addEventListener('click', function() {
                const btcAddress = document.getElementById('btc-address').textContent;
                navigator.clipboard.writeText(btcAddress).then(function() {
                    const originalText = document.getElementById('copy-btc-address').innerHTML;
                    document.getElementById('copy-btc-address').innerHTML = '<i class="fas fa-check me-1"></i> Copied!';
                    setTimeout(function() {
                        document.getElementById('copy-btc-address').innerHTML = originalText;
                    }, 2000);
                });
            });

            document.getElementById('copy-binance-id').addEventListener('click', function() {
                const binanceId = document.getElementById('binance-id').textContent;
                navigator.clipboard.writeText(binanceId).then(function() {
                    const originalText = document.getElementById('copy-binance-id').innerHTML;
                    document.getElementById('copy-binance-id').innerHTML = '<i class="fas fa-check me-1"></i> Copied!';
                    setTimeout(function() {
                        document.getElementById('copy-binance-id').innerHTML = originalText;
                    }, 2000);
                });
            });

            // Request real trading
            requestRealTradingBtn.addEventListener('click', function() {
                donationModal.show();
            });

            // Handle authorization code form submission
            authorizationCodeForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const enteredCode = document.getElementById('authCode').value.toUpperCase();
                
                // In a real implementation, this would be validated against a database
                // For demo purposes, we'll accept any 6-character code
                if (enteredCode.length === 6) {
                    // Activate real trading
                    isRealTrading = true;
                    
                    // Update UI
                    accountTypeEl.textContent = 'REAL';
                    accountTypeEl.className = 'account-type real-account';
                    accountIdEl.textContent = 'Real Trading Account';
                    authStatusEl.innerHTML = '<i class="fas fa-check-circle text-success"></i>';
                    
                    // Show success message
                    authStatusElModal.className = 'request-status status-approved';
                    authStatusElModal.innerHTML = '<i class="fas fa-check-circle me-2"></i>Real trading activated successfully!';
                    authStatusElModal.classList.remove('d-none');
                    
                    // Disable form
                    authorizationCodeForm.querySelector('button[type="submit"]').disabled = true;
                    
                    // Hide modal after 2 seconds
                    setTimeout(() => {
                        authorizationCodeModal.hide();
                    }, 2000);
                } else {
                    // Show error message
                    authStatusElModal.className = 'request-status status-rejected';
                    authStatusElModal.innerHTML = '<i class="fas fa-times-circle me-2"></i>Invalid authorization code. Please try again.';
                    authStatusElModal.classList.remove('d-none');
                }
            });

            // Simulate price data
            function generatePriceData() {
                const lastPrice = priceData.length > 0 ? priceData[priceData.length - 1] : 1000;
                const change = (Math.random() - 0.5) * 10;
                const newPrice = Math.max(100, lastPrice + change);
                priceData.push(newPrice);
                
                // Keep only last 50 data points
                if (priceData.length > 50) {
                    priceData.shift();
                }
                
                return newPrice;
            }

            // Calculate EMA
            function calculateEMA(data, period) {
                if (data.length < period) return null;
                
                const multiplier = 2 / (period + 1);
                let ema = data[0];
                
                for (let i = 1; i < data.length; i++) {
                    ema = (data[i] * multiplier) + (ema * (1 - multiplier));
                }
                
                return ema;
            }

            // Calculate RSI
            function calculateRSI(data, period) {
                if (data.length < period + 1) return null;
                
                let gains = 0;
                let losses = 0;
                
                for (let i = 1; i < data.length; i++) {
                    const diff = data[i] - data[i - 1];
                    if (diff > 0) gains += diff;
                    else losses -= diff;
                }
                
                const avgGain = gains / period;
                const avgLoss = losses / period;
                const rs = avgGain / avgLoss;
                
                return 100 - (100 / (1 + rs));
            }

            // Update indicators
            function updateIndicators() {
                const currentPrice = priceData[priceData.length - 1];
                currentPriceEl.textContent = currentPrice.toFixed(2);
                
                // Calculate EMAs
                const ema100 = calculateEMA(priceData, 100);
                const ema50 = calculateEMA(priceData, 50);
                
                // For EMA50_5, we'll simulate 5-minute data by taking every 5th point
                const ema50_5_data = [];
                for (let i = 0; i < priceData.length; i += 5) {
                    ema50_5_data.push(priceData[i]);
                }
                const ema50_5 = calculateEMA(ema50_5_data, 50);
                
                // Calculate RSI
                const rsi = calculateRSI(priceData, 2);
                
                // Update UI
                if (ema100 !== null) ema100El.textContent = ema100.toFixed(2);
                if (ema50 !== null) ema50El.textContent = ema50.toFixed(2);
                if (ema50_5 !== null) ema50_5El.textContent = ema50_5.toFixed(2);
                if (rsi !== null) rsiEl.textContent = rsi.toFixed(2);
                
                // Check conditions
                const cond1 = rsi !== null && rsi > 30;
                const cond2 = ema50_5 !== null && ema50_5 < currentPrice;
                const cond3 = ema100 !== null && ema50 !== null && ema100 < ema50;
                const cond4 = ema100 !== null && ema100 < currentPrice;
                
                // Update condition badges
                cond1El.textContent = cond1 ? 'True' : 'False';
                cond1El.className = cond1 ? 'badge bg-success' : 'badge bg-danger';
                
                cond2El.textContent = cond2 ? 'True' : 'False';
                cond2El.className = cond2 ? 'badge bg-success' : 'badge bg-danger';
                
                cond3El.textContent = cond3 ? 'True' : 'False';
                cond3El.className = cond3 ? 'badge bg-success' : 'badge bg-danger';
                
                cond4El.textContent = cond4 ? 'True' : 'False';
                cond4El.className = cond4 ? 'badge bg-success' : 'badge bg-danger';
                
                // Return if all conditions are met
                return cond1 && cond2 && cond3 && cond4;
            }

            // Execute trade
            function executeTrade() {
                const now = new Date();
                const timeString = now.toLocaleTimeString();
                const isWin = Math.random() > 0.5; // 50% chance to win
                const result = isWin ? 'Win' : 'Loss';
                const profit = isWin ? 0.05 : -0.5; // 5% win or 50% loss
                
                // Update balance
                const currentBalance = parseFloat(accountBalanceEl.textContent);
                const newBalance = currentBalance + (currentBalance * profit);
                accountBalanceEl.textContent = newBalance.toFixed(2);
                
                // Add to trade history
                tradeHistory.unshift({
                    time: timeString,
                    symbol: currentSymbol,
                    result: result
                });
                
                // Keep only last 5 trades
                if (tradeHistory.length > 5) {
                    tradeHistory.pop();
                }
                
                // Update trade history table
                updateTradeHistory();
                
                // Increment trade count
                tradeCount++;
                updateTradeCount();
                
                // Check if we need to switch after 3 trades
                if (tradeCount >= 3) {
                    switchSymbol();
                }
            }

            // Update trade history table
            function updateTradeHistory() {
                tradeHistoryEl.innerHTML = '';
                
                if (tradeHistory.length === 0) {
                    tradeHistoryEl.innerHTML = '<tr><td colspan="3" class="text-center">No trades yet</td></tr>';
                    return;
                }
                
                tradeHistory.forEach(trade => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${trade.time}</td>
                        <td>${trade.symbol}</td>
                        <td><span class="badge ${trade.result === 'Win' ? 'bg-success' : 'bg-danger'}">${trade.result}</span></td>
                    `;
                    tradeHistoryEl.appendChild(row);
                });
            }

            // Update trade count display
            function updateTradeCount() {
                tradeCountEl.textContent = tradeCount;
                switchTradeCountEl.textContent = `${tradeCount} / 3`;
            }

            // Switch symbol
            function switchSymbol() {
                // Toggle between CRASH900 and CRASH1000
                currentSymbol = currentSymbol === 'CRASH900' ? 'CRASH1000' : 'CRASH900';
                
                // Reset trade count
                tradeCount = 0;
                updateTradeCount();
                
                // Reset signal time
                lastSignalTime = null;
                
                // Clear switch timer
                if (switchTimer) {
                    clearTimeout(switchTimer);
                    switchTimer = null;
                }
                
                // Update UI
                currentSymbolEl.textContent = currentSymbol;
                switchCurrentSymbolEl.textContent = currentSymbol;
                
                // Update chart title
                tradingChart.data.datasets[0].label = `${currentSymbol} Price`;
                tradingChart.update();
                
                // Reset time elapsed display
                switchTimeElapsedEl.textContent = '0:00';
                switchTimeRemainingEl.textContent = '2:00';
            }

            // Update time elapsed display
            function updateTimeElapsed() {
                if (!lastSignalTime) {
                    switchTimeElapsedEl.textContent = '0:00';
                    switchTimeRemainingEl.textContent = '2:00';
                    return;
                }
                
                const now = new Date();
                const elapsedMs = now - lastSignalTime;
                const elapsedSeconds = Math.floor(elapsedMs / 1000);
                const elapsedMinutes = Math.floor(elapsedSeconds / 60);
                const remainingSeconds = 120 - elapsedSeconds;
                const remainingMinutes = Math.floor(remainingSeconds / 60);
                
                switchTimeElapsedEl.textContent = `${elapsedMinutes}:${(elapsedSeconds % 60).toString().padStart(2, '0')}`;
                switchTimeRemainingEl.textContent = `${remainingMinutes}:${(remainingSeconds % 60).toString().padStart(2, '0')}`;
                
                // Check if 2 minutes have passed
                if (elapsedSeconds >= 120) {
                    switchSymbol();
                }
            }

            // Strategy loop
            function strategyLoop() {
                // Generate new price data
                generatePriceData();
                
                // Update chart
                tradingChart.data.labels.push('');
                tradingChart.data.datasets[0].data.push(priceData[priceData.length - 1]);
                
                // Keep only last 50 data points
                if (tradingChart.data.labels.length > 50) {
                    tradingChart.data.labels.shift();
                    tradingChart.data.datasets[0].data.shift();
                }
                
                tradingChart.update();
                
                // Update indicators
                const shouldTrade = updateIndicators();
                
                // Execute trade if conditions are met
                if (shouldTrade) {
                    // Reset last signal time
                    lastSignalTime = new Date();
                    
                    // Clear any existing switch timer
                    if (switchTimer) {
                        clearTimeout(switchTimer);
                    }
                    
                    // Place 3 trades
                    for (let i = 0; i < 3; i++) {
                        executeTrade();
                    }
                }
            }

            // Start strategy
            startBtn.addEventListener('click', function() {
                if (isStrategyRunning) return;
                
                isStrategyRunning = true;
                startBtn.disabled = true;
                stopBtn.disabled = false;
                statusEl.innerHTML = '<i class="fas fa-circle me-2"></i> Strategy Running <span class="loading-spinner ms-2"></span>';
                statusEl.className = 'strategy-status status-running';
                
                // Start strategy loop
                strategyInterval = setInterval(strategyLoop, 2000); // Update every 2 seconds
                
                // Start time elapsed update
                timeElapsedInterval = setInterval(updateTimeElapsed, 1000);
            });

            // Stop strategy
            stopBtn.addEventListener('click', function() {
                if (!isStrategyRunning) return;
                
                isStrategyRunning = false;
                startBtn.disabled = false;
                stopBtn.disabled = true;
                statusEl.innerHTML = '<i class="fas fa-circle me-2"></i> Strategy Stopped';
                statusEl.className = 'strategy-status status-stopped';
                
                // Stop strategy loop
                clearInterval(strategyInterval);
                
                // Stop time elapsed update
                clearInterval(timeElapsedInterval);
                
                // Clear switch timer
                if (switchTimer) {
                    clearTimeout(switchTimer);
                    switchTimer = null;
                }
            });

            // Initialize with some data
            for (let i = 0; i < 30; i++) {
                generatePriceData();
            }
            
            // Initial chart update
            tradingChart.data.labels = Array(priceData.length).fill('');
            tradingChart.data.datasets[0].data = [...priceData];
            tradingChart.update();
            
            // Initial indicators update
            updateIndicators();
            
            // Initial trade count update
            updateTradeCount();
        });
    </script>
</body>
</html>
